---
language: java
jdk:
  - openjdk7
before_script:
  - psql -c 'create database cla;' -U postgres
after_success: |
  if [[ $TRAVIS_BRANCH == 'master' && $TRAVIS_SECURE_ENV_VARS == 'true' ]] ; then
    bundle install --binstubs
    bin/cf target $TARGET
    bin/cf login --username $USERNAME --password $PASSWORD --organization $ORGANIZATION --space $SPACE
    bin/cf push
  fi
env:
  global:
    - "DATABASE_URL=postgresql://travis@127.0.0.1:5432/cla"
    - "ENCRYPTION_KEY='OAI]TQ(aYvcyUMwzGpKh7HptueVQJPkCVSYjxpOOSZeVby4FWP'" # This is a test-only value
    -
      secure: T/zNcNbxbEhvK/egxkdI6sGyRyewuDEwITnCWYXHbrrwNgc1bGdgCKfaFI7flegQGNjTfdranoxWb69o7XPjUCW8YTKztycn3fv0NvQQmL2eTiQsVRyakpJ88UNOmwnsTu77k4oE156t9N9pHcnhmRbuqym0+CiEDWV/4j2M/RU= # $USERNAME
    -
      secure: YKcY/yTdw0ChjJD75k+7jGSroxLJpPWzD7XveOQFhqrcsNDPDUlsIiOLfvACJOddghNH2GAtBd0lmcE2bzWhRdYaRkhgfh/MjrH7eaU/ArDkcjdWAf/FTl8o9QXs1wJhiCZZVCpuRMBjLu8eqrnj43sdAKdj8S/OAzi3Y1kNh7w= # $PASSWORD
    -
      secure: bCCaiKwT/yu1mZKx8UIEcnaeEu7RVfmzk59lbYw3J+iGZYIdnGDhQMBECeGfttMzR6MCzARKeAf0laqkzsTmZqsU7e+lus9Anuwm5jP/6Yy3ZuuxirJXkKaf+S2JNOg3K8dvpgSMbC64Sx76VLpEI90tKs3gQ3XxyPo2QzVLpz8= # $ORGANIZATION
    -
      secure: CulVPY2MKRjoOWU7rC7JbN15PL1DFaPoqAqWiB74KMy6fnDQh+ribBDB1bF42aSS40gx7u59mMNn1QJWNQoFxGFaaRObFqB4FaduvTHqxB6pDM0IGa9+m989OCRea8N/eLT/yF7rAM811rP/aOJ2LpVbT9CZFaC4oWTD5S+Sok4= # $SPACE
    -
      secure: T/o1dHYbRm4xnvj6Tye4UUJr/70QvpHx4PYZZL/EFw5+qBXUtmY6kwLI7ZaQxUEtXWMvoFOowUxXwuTnotZQbSMnXeEmk4fz6w2sbYpUoqCeqEeo6Tp9G0Te9rOedoGrOx83VO7NjXiAIi4XLReZo/O6Uug9o4ssfaZ/m/WY5ds= # $TARGET
